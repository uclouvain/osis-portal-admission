{% load bootstrap3 i18n static admission enums %}

{% comment "License" %}
* OSIS stands for Open Student Information System. It's an application
* designed to manage the core business of higher education institutions,
* such as universities, faculties, institutes and professional schools.
* The core business involves the administration of students, teachers,
* courses, programs and so on.
*
* Copyright (C) 2015-2022 Universit√© catholique de Louvain (http://www.uclouvain.be)
*
* This program is free software: you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation, either version 3 of the License, or
* (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* A copy of this license - GNU General Public License - is available
* at the root of the source code of this program.  If not,
* see http://www.gnu.org/licenses/.
{% endcomment %}

{% if pk %}
  {% url base_namespace|add:':update:curriculum:educational_create' pk as curriculum_educational_create_url %}
  {% url base_namespace|add:':update:curriculum:professional_create' pk as curriculum_professional_create_url %}
{% else %}
  {% url 'admission:create:curriculum:educational_create' as curriculum_educational_create_url %}
  {% url 'admission:create:curriculum:professional_create' as curriculum_professional_create_url %}
{% endif %}

<div class="alert alert-info" role="alert">
  <p>
    {% blocktranslate trimmed with year=minimal_year|get_academic_year %}
      Please fill in what you have achieved since year {{ year }}.
    {% endblocktranslate %}
  </p>
</div>
<div class="panel panel-default">
  <div class="panel-heading flex-container">
    <h4 class="panel-title">{% translate "Academic trainings" %}</h4>
    {% if with_editing_options %}
      <a
          href="{{ curriculum_educational_create_url }}"
          class="btn btn-primary"
          aria-label="{% trans "Add a new academic experience" %}"
          title="{% trans "Add a new academic experience" %}"
      >
        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
        {% trans "Add" %}
      </a>
    {% endif %}
  </div>
  <div class="panel-body">
    {% if educational_experiences %}
      <table class="table table-striped">
        <thead>
        <tr>
          <th style="width: 150px;">{% translate "Period" %}</th>
          <th>{% translate "Training" %}</th>
          <th>{% translate "Institute" %}</th>
          <th style="width: 100px;">{% translate "Actions" %}</th>
        </tr>
        </thead>
        <tbody>
        {% for educational_experience in educational_experiences %}
          {% if pk %}
            {% url base_namespace|add:':update:curriculum:educational_update' pk educational_experience.uuid as experience_update_url %}
            {% url base_namespace|add:':curriculum:educational_read' pk educational_experience.uuid as experience_read_url %}
            {% url base_namespace|add:':update:curriculum:educational_delete' pk educational_experience.uuid as experience_delete_url %}
          {% else %}
            {% url 'admission:create:curriculum:educational_update' educational_experience.uuid as experience_update_url %}
            {% url 'admission:create:curriculum:educational_read' educational_experience.uuid as experience_read_url %}
            {% url 'admission:create:curriculum:educational_delete' educational_experience.uuid as experience_delete_url %}
          {% endif %}
          <tr>
            <td>
              {% with educational_experience.educationalexperienceyear_set|length as nb_years %}
                {% if nb_years > 0 %}
                  {{ educational_experience.educationalexperienceyear_set.0.academic_year|get_academic_year }}
                  {% if nb_years > 1 %}
                    {% translate 'to' %}
                    {% with educational_experience.educationalexperienceyear_set|last as last_experience %}
                      {{ last_experience.academic_year|get_academic_year }}
                    {% endwith %}
                  {% endif %}
                {% endif %}
              {% endwith %}
            </td>
            <td><span>{{ educational_experience.education_name }}</span></td>
            <td><span>{{ educational_experience.institute_name }}</span></td>
            <td>
              <div class="btn-group" role="group">
                {% if with_editing_options %}
                  {% if educational_experience.valuated_from_doctorateadmission %}
                    <span
                        class="glyphicon glyphicon-check btn btn-default disabled"
                        title="{% trans "This experience has been valuated so cannot be updated." %}"
                        aria-label="{% trans "This experience has been valuated so cannot be updated." %}"
                    ></span>
                  {% else %}
                    <a
                        href="{{ experience_update_url }}"
                        class="btn btn-default"
                        aria-label="{% translate "Update the experience" %}"
                        title="{% translate "Update the experience" %}"
                    >
                      <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                    </a>
                    <a
                        href="{{ experience_delete_url }}"
                        class="btn btn-danger"
                        aria-label="{% translate "Remove the experience" %}"
                        title="{% translate "Remove the experience" %}"
                    >
                      <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                    </a>
                  {% endif %}
                {% else %}
                  <a
                      href="{{ experience_read_url }}"
                      class="btn btn-default"
                      aria-label="{% translate "See the experience details" %}"
                      title="{% translate "See the experience details" %}"
                  >
                    <span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span>
                  </a>
                {% endif %}
              </div>
            </td>
          </tr>
        {% endfor %}
        <tr></tr>
        </tbody>
      </table>
    {% else %}
      {% trans "The CV doesn't yet contain any educational experience." %}
    {% endif %}
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading flex-container">
    <h4 class="panel-title">{% translate "Non-academic background" %}</h4>
    {% if with_editing_options %}
      <a
          href="{{ curriculum_professional_create_url }}"
          class="btn btn-primary"
          aria-label="{% translate "Add a new non-academic experience" %}"
          title="{% translate "Add a new non-academic experience" %}"
      >
        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
        {% trans "Add" %}
      </a>
    {% endif %}
  </div>
  <div class="panel-body">
    {% if professional_experiences %}
      <table class="table table-striped">
        <thead>
        <tr>
          <th style="width: 150px;">{% translate "Period" %}</th>
          <th>{% translate "Activity type" %}</th>
          <th>{% translate "Institute" %}</th>
          <th style="width: 100px;">{% translate "Actions" %}</th>
        </tr>
        </thead>
        <tbody>
        {% for professional_experience in professional_experiences %}
          {% if pk %}
            {% url base_namespace|add:':update:curriculum:professional_update' pk professional_experience.uuid as experience_update_url %}
            {% url base_namespace|add:':curriculum:professional_read' pk professional_experience.uuid as experience_read_url %}
            {% url base_namespace|add:':update:curriculum:professional_delete' pk professional_experience.uuid as experience_delete_url %}
          {% else %}
            {% url 'admission:create:curriculum:professional_update' professional_experience.uuid as experience_update_url %}
            {% url 'admission:create:curriculum:professional_read' professional_experience.uuid as experience_read_url %}
            {% url 'admission:create:curriculum:professional_delete' professional_experience.uuid as experience_delete_url %}
          {% endif %}
          <tr>
            <td>
              {% with start_date=professional_experience.start_date|date:"YEAR_MONTH_FORMAT" end_date=professional_experience.end_date|date:"YEAR_MONTH_FORMAT"  %}
                {{ start_date }}
                {% if start_date != end_date %}
                  {% translate "to" %}
                  {{ end_date }}
                {% endif %}
              {% endwith %}
            </td>
            <td><span>{{ professional_experience.type.value|enum_display:'ActivityType' }}</span></td>
            <td><span>{{ professional_experience.institute_name }}</span></td>
            <td>
              <div class="btn-group" role="group">
                {% if with_editing_options %}
                  {% if professional_experience.valuated_from_doctorateadmission %}
                    <span
                        class="glyphicon glyphicon-check btn btn-default disabled"
                        title="{% trans "This experience has been valuated so cannot be updated." %}"
                        aria-label="{% trans "This experience has been valuated so cannot be updated." %}"
                    ></span>
                  {% else %}
                    <a
                        href="{{ experience_update_url }}"
                        class="btn btn-default"
                        aria-label="{% translate "Update the experience" %}"
                        title="{% translate "Update the experience" %}"
                    >
                      <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                    </a>
                    <a
                        href="{{ experience_delete_url }}"
                        class="btn btn-danger"
                        aria-label="{% translate "Remove the experience" %}"
                        title="{% translate "Remove the experience" %}"
                    >
                      <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                    </a>
                  {% endif %}
                {% else %}
                  <a
                      href="{{ experience_read_url }}"
                      class="btn btn-default"
                      aria-label="{% translate "See the experience details" %}"
                      title="{% translate "See the experience details" %}"
                  >
                    <span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span>
                  </a>
                {% endif %}
              </div>
            </td>
          </tr>
        {% endfor %}
        <tr></tr>
        </tbody>
      </table>
    {% else %}
      {% trans "The CV doesn't yet contain any non-academic experience." %}
    {% endif %}
  </div>
</div>

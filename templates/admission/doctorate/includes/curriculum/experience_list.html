{% load bootstrap3 i18n static admission %}

{% comment "License" %}
* OSIS stands for Open Student Information System. It's an application
* designed to manage the core business of higher education institutions,
* such as universities, faculties, institutes and professional schools.
* The core business involves the administration of students, teachers,
* courses, programs and so on.
*
* Copyright (C) 2015-2022 Universit√© catholique de Louvain (http://www.uclouvain.be)
*
* This program is free software: you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation, either version 3 of the License, or
* (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* A copy of this license - GNU General Public License - is available
* at the root of the source code of this program.  If not,
* see http://www.gnu.org/licenses/.
{% endcomment %}

{% for experience in curriculum_experiences %}

    {% ifchanged experience.curriculum_year.academic_year %}
        <h4 class="experience-year bg-info">{{ experience.curriculum_year.academic_year }}-{{ experience.curriculum_year.academic_year|add:"1" }}</h4>
    {% endifchanged %}

    <details class="experience panel panel-default" open>

        <summary class="panel-heading">
            <h5>{{ experience.type.value|enum_display:"ExperienceType" }} - {{ experience.country.name }}</h5>
            <div class="experience-actions">
                {% if experience.is_valuated %}
                    <span
                        class="glyphicon glyphicon-check"
                        title="{% trans "This experience has been valuated." %}"
                        aria-label="{% trans "This experience has been valuated." %}"
                    ></span>
                {% elif with_editing_options %}
                    <a
                        class="btn btn-primary glyphicon glyphicon-pencil"
                        aria-label="{% trans "Update" %}"
                        {% if experience.uuid == view.kwargs.experience_id|stringformat:"s" %}
                        data-toggle="modal"
                        data-target="#{{ forms.update_form.prefix }}"
                        {% elif view.kwargs.pk %}
                        href="{% url 'admission:doctorate-update:curriculum' pk=view.kwargs.pk experience_id=experience.uuid %}"
                        {% else %}
                        href="{% url 'admission:doctorate-create:curriculum' experience_id=experience.uuid %}"
                        {% endif %}
                    ></a>
                    <button
                        class="btn btn-danger"
                        data-toggle="modal"
                        data-target="#confirmation-modal"
                        data-confirmed-id="{{ experience.uuid }}"
                        aria-label="{% trans "Delete" %}"
                    >
                        <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                    </button>
                {% endif %}
            </div>
        </summary>

        <div class="panel-body">

            {% if experience.type.value == 'OTHER_ACTIVITY' %}
                {% if experience.activity_type.value != 'UNEMPLOYMENT' and experience.activity_type.value != 'ILLNESS' %}
                    {% panel _('Institute') title_level=6 %}
                        {% field_data _("Institute name") experience.institute_name hide_empty=True %}
                        {% field_data _("Institute city") experience.institute_city %}
                    {% endpanel %}
                {% endif %}
                {% panel _('Activity') title_level=6 %}
                    <div class="row">
                        {% field_data _("Type") experience.activity_type.value|enum_display:"ActivityType"|default:experience.other_activity_type css_class="col-md-6" hide_empty=True %}
                        {% field_data _("Activity position") experience.activity_position css_class="col-md-6" hide_empty=True %}
                    </div>
                    {% field_data _("Activity certificate") experience.activity_certificate %}
                {% endpanel %}

            {% elif experience.type.value == 'HIGHER_EDUCATION' and experience.country.iso_code == 'BE' %}
                {% panel _('Institute') title_level=6 %}
                    {% field_data _("Institute name") experience.institute.name|default:experience.institute_name %}
                    {% field_data _("Education community") experience.belgian_education_community.value|enum_display:"BelgianCommunitiesOfEducation" %}
                    <div class="row">
                        {% field_data _("Institute city") experience.institute_city css_class="col-md-6" hide_empty=True %}
                        {% field_data _("Institute postal code") experience.institute_postal_code css_class="col-md-6" hide_empty=True %}
                    </div>
                {% endpanel %}
                {% panel _('Studies') title_level=6 %}
                    <div class="row">
                        {% if experience.belgian_education_community.value == 'FRENCH_SPEAKING' %}
                            {% field_data _("Program") experience.program.title|default:experience.education_name css_class="col-md-6"%}
                        {% else %}
                            {% field_data _("Name of the diploma or of the education") experience.education_name css_class="col-md-6"%}
                        {% endif %}
                        {% field_data _("Study system") experience.study_system.value|enum_display:"StudySystem" css_class="col-md-6" %}
                    </div>
                {% endpanel %}
                {% panel _('Results') title_level=6 %}
                    <div class="row">
                        {% field_data _("Result") experience.result.value|enum_display:"Result" css_class="col-md-6" %}
                        {% field_data _("Is it your graduation year?") experience.graduation_year|yesno:_("Yes,No") css_class="col-md-6" hide_empty=True %}
                    </div>
                    {% if experience.graduation_year %}
                        <div class="row">
                            {% field_data _("Obtained grade") experience.obtained_grade.value|enum_display:"Grade" css_class="col-md-6" %}
                            {% field_data _("Rank in diploma") experience.rank_in_diploma css_class="col-md-6" %}
                        </div>
                        <div class="row">
                            {% field_data _("Issue diploma date") experience.issue_diploma_date css_class="col-md-6" %}
                            {% field_data _("Graduate degree") experience.graduate_degree css_class="col-md-6" %}
                        </div>
                    {% endif %}
                    <hr>
                    <div class="row">
                        {% field_data _("Credit type") experience.credit_type.value|enum_display:"CreditType" css_class="col-md-6" %}
                        {% field_data _("Acquired credit number") experience.acquired_credits_number|add_str:_(" on ")|add_str:experience.entered_credits_number css_class="col-md-6" %}
                    </div>
                    {% field_data _("Transcript") experience.transcript %}
                    {% field_data _("Access certificate after a 60 master") experience.access_certificate_after_60_master hide_empty=True %}
                    <hr>
                    {% field_data _("Title of the dissertation") experience.dissertation_title %}
                    <div class="row">
                        {% field_data _("Dissertation summary") experience.dissertation_summary css_class="col-md-6" %}
                        {% field_data _("Dissertation score") experience.dissertation_score css_class="col-md-6" %}
                    </div>
                {% endpanel %}
            {% else %}

                {% panel _('Institute') title_level=6 %}
                    {% field_data _("Institute name") experience.institute.name|default:experience.institute_name %}
                    <div class="row">
                        {% field_data _("Institute city") experience.institute_city css_class="col-md-6" hide_empty=True %}
                        {% field_data _("Institute postal code") experience.institute_postal_code css_class="col-md-6" hide_empty=True %}
                    </div>
                {% endpanel %}
                {% panel _('Studies') title_level=6 %}
                    {% field_data _("Program") experience.education_name %}
                    <div class="row">
                        {% field_data _("Linguistic regime") experience.linguistic_regime.name css_class="col-md-6" %}
                        {% field_data _("Study cycle type") experience.study_cycle_type.value|enum_display:"ForeignStudyCycleType" css_class="col-md-6" %}
                    </div>
                {% endpanel %}
                {% panel _('Results') title_level=6 %}
                    <div class="row">
                        {% field_data _("Result") experience.result.value|enum_display:"Result" css_class="col-md-6" %}
                        {% field_data _("Is it your graduation year?") experience.graduation_year|yesno:_("Yes,No") css_class="col-md-6" hide_empty=True %}
                    </div>
                    {% if experience.graduation_year %}
                        <div class="row">
                            {% field_data _("Obtained grade") experience.obtained_grade.value|enum_display:"Grade" css_class="col-md-6" %}
                            {% field_data _("Rank in diploma") experience.rank_in_diploma css_class="col-md-6" %}
                        </div>
                        {% field_data _("Issue diploma date") experience.issue_diploma_date %}
                        <div class="row">
                            {% field_data _("Graduate degree") experience.graduate_degree css_class="col-md-6" %}
                            {% field_data _("Graduate degree translation") experience.graduate_degree_translation css_class="col-md-6" %}
                        </div>
                    {% endif %}
                    <hr>
                    <div class="row">
                        {% field_data _("Credit type") experience.credit_type.value|enum_display:"CreditType" css_class="col-md-6" %}
                        {% field_data _("Acquired credit number") experience.acquired_credits_number|add_str:_(" on ")|add_str:experience.entered_credits_number css_class="col-md-6" %}
                    </div>
                    <div class="row">
                        {% field_data _("Transcript") experience.transcript css_class="col-md-6" %}
                        {% field_data _("Transcript translation") experience.transcript_translation css_class="col-md-6" %}
                    </div>
                    {% field_data _("Access certificate after a 60 master") experience.access_certificate_after_60_master hide_empty=True %}
                    <hr>
                    {% field_data _("Title of the dissertation") experience.dissertation_title %}
                    <div class="row">
                        {% field_data _("Dissertation summary") experience.dissertation_summary css_class="col-md-6" %}
                        {% field_data _("Dissertation score") experience.dissertation_score css_class="col-md-6" %}
                    </div>
                {% endpanel %}

            {% endif %}
        </div>

    </details>

{% empty %}

    {% panel %}
        {% trans "The CV doesn't yet contain any experience." %}
    {% endpanel %}

{% endfor %}
